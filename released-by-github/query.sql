#standardSQL
WITH
  events AS (
    SELECT *
    FROM `githubarchive.day.2016*`
  ),

  stars AS (
    SELECT
      events.repo.id AS id,
      count(*) AS count
    FROM events
    WHERE events.type = 'WatchEvent'
    GROUP BY id
  )

SELECT
  events.repo.name AS repo,
  stars.count AS star_count
FROM events
JOIN stars ON stars.id = events.repo.id
WHERE
  (
    actor.login IN ("github", "primer", "octokit", "education", "jekyll", "atom", "electron") OR
    actor.login IN ("achiu", "johnjoubert", "aden", "alysonla", "amateurhuman", "ammeep", "anna", "antonio", "aroben", "sukoonmusic", "c-sefkin", "willf", "azizshamim", "b4mboo", "balevine", "bdemott", "benbalter", "chihiroto", "bernars", "bfire", "bhuga", "bigred", "bkeepers", "bleikamp", "brianmario", "BrittRinella", "brntbeer", "buckelij", "bvopinek", "Caged", "celsmore", "charliesome", "chrishunt", "ciaramcguire", "cobyism", "Coecoe", "connors", "craigreyes", "ann-mary", "davideg", "dbussink", "defunkt", "EddPatterson", "devinreams", "dewski", "dgraham", "dice", "donal", "dproano", "dreww", "dsorkin", "gracepark", "JennieOhyoung", "eanderson", "ElizabethN", "emilyistoofunky", "erebor", "jimmyokami", "kimestoesta", "sturnquest", "fabianperez", "fernandez", "Foggybtmgirl", "fooforge", "gjtorikian", "gpadak", "grantr", "gregose", "Haacked", "haleygirl", "HollyTuray", "hoolio", "izuzak", "jakeboxer", "jakedouglas", "jameswhite", "jammur", "MikeT", "jasonlong", "jasonrudolph", "jatoben", "jbarnette", "jch", "jdennes", "jdmaturen", "jdpace", "jeejkang", "jeffmjones", "jessephus", "jesseplusplus", "jglovier", "jgreet", "jhosman", "jhunnewell", "jnewland", "jnunemaker", "joewadcan", "joewilliams", "JohnCreek", "johndbritton", "johnyerhot", "jonmagic", "jonrohan", "jordanmccullough", "josh", "joshaber", "joshvera", "jroll", "jssjr", "juliamae", "kateguarente", "kdaigle", "keavy", "keithduncan", "kelseyschimm", "kevinsawicki", "dara-leigh", "leefaus", "leehuffman", "leereilly", "lildude", "lisalou", "sarahs", "lukehefson", "lynnwallenstein", "maddox", "madrid", "mastahyeti", "matthewmccullough", "mattyoho", "maxbrunsfeld", "mbhartley", "mcolyer", "mdo", "meatcoder", "megches", "merrittqa", "mfilosa", "mgriffin", "mhagger", "michaeltwofish", "mikemcquaid", "mislav", "mtodd", "muan", "mutle", "nakajima", "nathansobo", "neechbomb", "newmerator", "nickh", "niik", "that-pat", "waldnzwrld", "oreoshake", "pakwit", "pamboat", "pastjohn", "peff", "pengwynn", "petros", "piki", "pjhyett", "pmn", "probablycorey", "ptoomey3", "zacharysarah", "rathjenc", "rmulcahy", "robrix", "rsanheim", "rsese", "rubiojr", "rubyist", "samlambert", "sanicki", "sbryant", "ScarlettSparks", "scottjg", "shana", "shawndavenport", "shayfrendt", "shiftkey", "simonsj", "skalnik", "sophiec", "southgate", "spicycode", "spraints", "sroberts", "steveward", "talniv", "tclem", "technicalpickles", "technoweenie", "tjl2", "tmm1", "tonyjaramillo", "TwP", "vjayn", "vmg", "wstefano", "zcbenz", "zerowidth", "zoeweidz", "crichID", "epemmerl", "JesperHyrm", "loranallensmith", "mattcantstop", "mhp", "ross", "ShikhaThakkar", "tfgrimes", "moby", "PatrickBM", "brennaheaps", "evelDK", "kjpomerleau", "michelle100", "meentastic", "LindsaySJ", "TessaGit", "tpigott", "annieherlitz", "cjs", "githogan", "shannonhines", "toomanyaaronbrowns", "willemvandermark", "franniez", "anaisgonzalez", "brookienoodle", "jbjonesjr", "DennieBates", "Neeners", "padma007", "theojulienne", "ikeike443", "emcgrew", "fatcomma", "markostar", "nathos", "stephbwills", "kaihj", "meganlefever", "nigelabbott", "rocio-delgado", "cmrberry", "mynameisbill", "happylil3", "helaili", "jemoll", "nmsanchez", "jgkite", "asseh", "jastri", "agelender", "bescalante", "bitoiu", "carolynshin", "katelynbryant", "KyleMacey", "coryvj", "courtlandia", "dq-turtle", "jonahberquist", "kimsekulich", "kluczenk", "MaryWheeler", "mendyslaton", "Brits02", "brittpwalker", "broccolini", "brotherben", "bryanaknight", "bswinnerton", "bwestover", "carlosmn", "CarmenPalMar", "cheshire137", "chrisjahn", "chrismwendt", "ClayNelson", "cmwinters", "craigbarrere", "dalen", "danayel", "dandatt", "DanielMarconetto", "daniloc", "DarcyCK", "DaveEide", "davidcelis", "aaronbbrown", "abannick", "akinaito", "AlaineN", "alexandrakelly", "allthedoll", "alrightjones", "Amy-Worth", "AnthonyS", "arthurnn", "atiff", "atm1", "barbkoz", "bas", "bbasata", "BenEddy", "BinaryMuse", "BonnieC", "deanmunslow", "digitalemcee", "diwakargupta11", "djdefi", "donokuda", "electroniko", "ErinCall", "ethomson", "brainstarr", "evanrodriguez", "Fermentedbeats", "finkDC", "FrancineLisa", "francisfuzz", "frconil", "GeorgiCodes", "ggunson", "gnawhleinad", "harsh", "hax66", "hertogjanduevel", "hohsiangwu", "ihavenotea", "imgonnarelph", "iolsen", "jamesjlee11", "jamesmartin", "janester", "jasonmassey", "jayswan", "JennLachman", "Jentam", "jes5199", "jessicard", "jjhonson", "jldec", "jleaver", "jmarlena", "jmilas", "jordemort", "jpbouchard", "junfuji", "justinmccormick", "jwiebalk", "jwsocal", "k8d", "kakuls", "keeran", "Kingerr", "Kingmichaelj", "kpaulisse", "kuychaco", "kzadeh", "lachlanhardy", "lee-dohm", "lilliSeBe", "LizzHale", "LizzyKemp", "maki1022", "marcusramos", "marisa", "megbird", "mellybess", "mfrosen", "micahcroff", "michelemt", "michellini", "MikeNwin", "missinformed", "mlinksva", "Mlohoury", "msbise", "mwiesen", "NadaAldahleh", "NataliaHarakka", "nelson-steven", "nickcannariato", "nixpad", "nplasterer", "nsqe", "ohitsmekatie", "omgitsads", "paladique", "papimenon", "parkr", "parthd24", "patriciadavico", "pholleran", "pmarsceill", "pnsk", "rafer", "remywestin", "rewinfrey", "Richardstraat", "rkarthikeyan5", "rohinisf", "ronnie", "samuelhunt", "sandhub", "saraford", "sherrinetan", "shlomi-noach", "shortsparty", "Shreekar1", "simurai", "sjarolimek", "sleepysam", "snh", "sophshep", "staceb", "stevecat", "stoe", "suniljoseph", "suziejurado", "svenstaa", "swinton", "tarebyte", "tberman", "theseawitch", "tiabobia", "ticachica", "tierninho", "tma", "tmaher", "tomkrouper", "toyae", "veesa", "vinmat", "vmramirez", "webdog", "WillAbides", "wingr", "woodmanzee", "xducati620", "xhermann", "yourfrienderin", "zawaideh", "dekigai", "pifafu", "reversaw", "tcbyrd", "Teaford", "tenderlove", "kganes2", "neev7", "lecoursen", "ThatStoney", "brandonblack", "CoralineAda", "affrae", "AlexAmsterdam", "AlexPurkiss", "aymannadeem", "bluemazzoo", "carriemoser", "dmleong", "dolcetta", "KT2016", "leithiaRVA", "miguelff", "ntagg", "rhettg", "sambong", "sarabartell", "shreyasjoshis", "skimbro", "sofiehoeg", "tmaltiel", "tstone92", "victoiremulliez", "brianamarie", "fossygirl", "kamilahgriffin", "katmeister", "mistydemeo", "peggysf", "rosecoogan", "sbarnekow", "zeke", "AndrewCamp", "doublemarket", "bungdonuts", "chronicleofnerdia", "halfaro1", "harrisonleavitt", "hktouw", "jkrmr", "katfoz", "kdraps", "acmccall", "kneemer", "KristinaMarie", "mclark", "NatalieGrace", "arthurschreiber", "chobberoni", "craigmorrall", "osowskit", "el33", "dimmykumont", "fabien965", "jamfish", "jonico", "k33g", "m-air", "MarcoHat", "mosborne24", "nadiajoyce", "othercasey", "pravipati", "reem-a", "RuedigerEbber", "SWAKA", "wordsoup", "EprisBlank", "timothywellsjr", "chadjlucas", "hugginz", "mikrobi", "AllisonZhornist", "cvfernandez", "grokys", "jialeec", "kivikakk", "Lieke22", "mfrisky", "rubyjazzy", "seemakamath", "Tracol", "evilshawn", "NikiLustig", "panand71", "as-cii", "Raulv81", "rushtonmd", "kytrinyx", "lowply", "mcadoo", "Nickismyname", "terrorobe", "freakingid", "ACyphus", "amitbhatia", "beardofedu", "bevns", "kemjo", "mslilylove", "pbdunn", "sridharavinash", "groundwater", "stephaniemaria", "hollenberry", "JodiDelman", "melscoop", "NedMorris", "ttaylorr", "brentjo", "antn", "BastiaanHendriks", "Briroth", "bryancross", "canuckjacq", "doctorwholock", "femisimon", "heyhayhay", "hubberjay", "jules-p", "kathodos", "ktfeucht", "lukeart", "oriandaleigh", "shawnajean", "liliawu", "piqrgb", "camicano", "corywilkerson", "damieng", "emrichard", "nayafia", "ryanpamela", "sophaskins", "skottler", "swannysec", "joenash", "migarjo", "talktopri", "wi11ialvl")
  )
  AND
  (
    events.type = 'PublicEvent' OR
    (events.type = 'RepositoryEvent' AND JSON_EXTRACT_SCALAR(events.payload, '$.action') IN ('publicized', 'created'))
  )
ORDER BY star_count DESC
;
